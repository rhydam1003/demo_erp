(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[525],{48:function(e,t,s){Promise.resolve().then(s.bind(s,5842))},5842:function(e,t,s){"use strict";s.d(t,{default:function(){return u}});var r=s(7437),a=s(2265),n=s(6463),l=s(5137),o=s(2940),c=s(8030);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,c.Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),d=(0,c.Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);function u(){let e=(0,n.useRouter)(),[t,s]=(0,a.useState)([]),[c,u]=(0,a.useState)(!0),[m,h]=(0,a.useState)(!1),[x,b]=(0,a.useState)(!1),[f,g]=(0,a.useState)("");(0,a.useEffect)(()=>{s([]),b(!1),g(""),p()},[]);let p=async()=>{u(!0);try{let t=await fetch("/api/auth/me",{cache:"no-store",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache"}});if(!t.ok){e.push("/login");return}let r=await t.json();if(!r.student){e.push("/login");return}g(r.student.id);let a=await fetch("/api/courses",{cache:"no-store",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache"}});if(!a.ok){console.error("Failed to fetch courses"),s([]),b(!1),u(!1);return}let n=(await a.json()).courses||[];console.log("Fetched courses:",n.length),s(n);let l=await fetch("/api/feedback/final-submit",{cache:"no-store",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache"}});if(!l.ok){console.error("Failed to fetch submission status"),b(!1),u(!1);return}let o=await l.json();console.log("Submission data:",o),o.submission&&o.submission.studentId===r.student.id&&!0===o.submission.finalSubmit?(console.log("Student has final submitted"),b(!0)):(console.log("Student has NOT final submitted"),b(!1))}catch(e){console.error("Error fetching data:",e),b(!1),s([])}finally{u(!1)}},w=async()=>{if(window.confirm("Are you sure? You cannot edit feedback after final submission.")){h(!0);try{let t=await fetch("/api/feedback/final-submit",{method:"POST"}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to submit");alert("\uD83C\uDF89 All feedbacks submitted successfully!"),b(!0),e.push("/feedback/success")}catch(e){alert(e.message)}finally{h(!1)}}},y=t.every(e=>e.feedbackCompleted);return c?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Loading courses..."})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6",children:(0,r.jsx)("div",{className:"max-w-5xl mx-auto",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[(0,r.jsxs)("div",{className:"mb-6 pb-6 border-b-2",children:[(0,r.jsxs)("button",{onClick:()=>e.push("/dashboard"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 mb-4 transition-colors",children:[(0,r.jsx)(l.Z,{className:"w-5 h-5"}),(0,r.jsx)("span",{children:"Back to Dashboard"})]}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Feedback Section"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"Current Semester Courses"})]}),(0,r.jsx)("div",{className:"space-y-4 mb-6",children:0===t.length?(0,r.jsx)("div",{className:"p-6 bg-yellow-50 border-2 border-yellow-300 rounded-xl text-center",children:(0,r.jsx)("p",{className:"text-yellow-800 font-medium",children:"No courses found for your semester."})}):t.map(t=>(0,r.jsx)("div",{className:"border-2 border-gray-200 rounded-xl p-6 hover:border-blue-400 transition-all hover:shadow-md",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,r.jsx)("span",{className:"font-bold text-lg text-blue-600",children:t.code}),(0,r.jsx)("span",{className:"text-lg font-semibold text-gray-800",children:t.name})]}),(0,r.jsxs)("p",{className:"text-gray-600",children:[(0,r.jsx)("span",{className:"font-medium",children:"Teacher:"})," ",t.teacher.name]}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:t.teacher.department})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"flex items-center gap-2",children:t.feedbackCompleted?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{className:"w-6 h-6 text-green-600"}),(0,r.jsx)("span",{className:"text-sm font-semibold text-green-600",children:"Completed"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i,{className:"w-6 h-6 text-red-600"}),(0,r.jsx)("span",{className:"text-sm font-semibold text-red-600",children:"Pending"})]})}),(0,r.jsxs)("button",{onClick:()=>e.push("/feedback/".concat(t.id)),disabled:x,className:"px-6 py-3 rounded-lg font-semibold transition-all flex items-center gap-2 ".concat(x?"bg-gray-200 text-gray-500 cursor-not-allowed":t.feedbackCompleted?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-blue-600 text-white hover:bg-blue-700 shadow-md hover:shadow-lg"),children:[t.feedbackCompleted?"View":"Give Feedback",(0,r.jsx)(d,{className:"w-5 h-5"})]})]})]})},t.id))}),t.length>0&&y&&!x&&(0,r.jsx)("button",{onClick:w,disabled:m,className:"w-full bg-green-600 text-white py-4 rounded-xl font-bold text-lg hover:bg-green-700 transition-all shadow-lg hover:shadow-xl disabled:bg-green-300",children:m?"Submitting...":"✓ Final Submit All Feedbacks"}),t.length>0&&x&&(0,r.jsxs)("div",{className:"p-6 bg-green-50 border-2 border-green-300 rounded-xl text-center",children:[(0,r.jsx)(o.Z,{className:"w-12 h-12 text-green-600 mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-lg font-bold text-green-800",children:"All Feedbacks Submitted Successfully!"}),(0,r.jsx)("p",{className:"text-sm text-green-700 mt-2",children:"Your feedback has been locked and cannot be edited."})]}),t.length>0&&!y&&!x&&(0,r.jsxs)("div",{className:"p-6 bg-yellow-50 border-2 border-yellow-300 rounded-xl",children:[(0,r.jsx)("p",{className:"text-yellow-800 font-medium",children:"⚠️ Complete feedback for all courses to enable Final Submit"}),(0,r.jsxs)("p",{className:"text-sm text-yellow-700 mt-2",children:["Completed: ",t.filter(e=>e.feedbackCompleted).length," / ",t.length]})]})]})})})}},8030:function(e,t,s){"use strict";s.d(t,{Z:function(){return c}});var r=s(2265);/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&s.indexOf(e)===t).join(" ")};/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,r.forwardRef)((e,t)=>{let{color:s="currentColor",size:a=24,strokeWidth:o=2,absoluteStrokeWidth:c,className:i="",children:d,iconNode:u,...m}=e;return(0,r.createElement)("svg",{ref:t,...l,width:a,height:a,stroke:s,strokeWidth:c?24*Number(o)/Number(a):o,className:n("lucide",i),...m},[...u.map(e=>{let[t,s]=e;return(0,r.createElement)(t,s)}),...Array.isArray(d)?d:[d]])}),c=(e,t)=>{let s=(0,r.forwardRef)((s,l)=>{let{className:c,...i}=s;return(0,r.createElement)(o,{ref:l,iconNode:t,className:n("lucide-".concat(a(e)),c),...i})});return s.displayName="".concat(e),s}},5137:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(8030).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},2940:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(8030).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},6463:function(e,t,s){"use strict";var r=s(1169);s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})}},function(e){e.O(0,[971,23,744],function(){return e(e.s=48)}),_N_E=e.O()}]);